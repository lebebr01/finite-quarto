<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brandon LeBeau">
<meta name="dcterms.date" content="2025-09-24">

<title>simglm v0.9.22: Propensity Score Simulation – Brandon LeBeau</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//images/bl_favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-55373f81aad687d9e5c9f061504c548c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-95bd368a27abdcadd26b2436c52b31a5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-14CK5K9RD6"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-14CK5K9RD6', { 'anonymize_ip': true});
</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="simglm v0.9.22: Propensity Score Simulation – Brandon LeBeau">
<meta property="og:description" content="Academic website and blog">
<meta property="og:image" content="https://brandonlebeau.org/posts/2025-09-24-simglm-propensity_files/figure-html/unnamed-chunk-4-1.png">
<meta property="og:site_name" content="Brandon LeBeau">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Brandon LeBeau</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../posts/"> 
<span class="menu-text">Educate-R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../publications/"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../presentations/"> 
<span class="menu-text">Presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../packages/"> 
<span class="menu-text">R Packages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about/"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simglm-simulation-for-propensity-scores" id="toc-simglm-simulation-for-propensity-scores" class="nav-link active" data-scroll-target="#simglm-simulation-for-propensity-scores"><code>simglm</code> simulation for propensity scores</a>
  <ul class="collapse">
  <li><a href="#age-balance" id="toc-age-balance" class="nav-link" data-scroll-target="#age-balance">Age balance</a></li>
  <li><a href="#ses-balance" id="toc-ses-balance" class="nav-link" data-scroll-target="#ses-balance">SES balance</a></li>
  </ul></li>
  <li><a href="#full-data-simulation-with-propensity-scores" id="toc-full-data-simulation-with-propensity-scores" class="nav-link" data-scroll-target="#full-data-simulation-with-propensity-scores">Full data simulation with propensity scores</a></li>
  <li><a href="#estimate-propensity-models-with-simglm" id="toc-estimate-propensity-models-with-simglm" class="nav-link" data-scroll-target="#estimate-propensity-models-with-simglm">Estimate propensity models with <code>simglm</code></a>
  <ul class="collapse">
  <li><a href="#covariate-adjusted-model" id="toc-covariate-adjusted-model" class="nav-link" data-scroll-target="#covariate-adjusted-model">Covariate-adjusted model</a></li>
  <li><a href="#inverse-propensity-score-weighting" id="toc-inverse-propensity-score-weighting" class="nav-link" data-scroll-target="#inverse-propensity-score-weighting">Inverse Propensity Score Weighting</a></li>
  <li><a href="#stabilized-propensity-score-weighting" id="toc-stabilized-propensity-score-weighting" class="nav-link" data-scroll-target="#stabilized-propensity-score-weighting">Stabilized Propensity Score Weighting</a></li>
  </ul></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">simglm v0.9.22: Propensity Score Simulation</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">simglm</div>
    <div class="quarto-category">simulation</div>
    <div class="quarto-category">propensity scores</div>
  </div>
  </div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brandon LeBeau </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>I haven’t written about my <code>simglm</code> package in a while. Behind the scenes, numerous changes have been made to enhance the package. The current CRAN version is significantly behind, but my goal is to submit the most recent version to CRAN soon, once I finalize the details for my upcoming book on simulation and power analysis with R, published by CRC Press.</p>
<p>One of the final implementations required for this book is conducting a simulation and power analysis for propensity scores. Propensity scores can be helpful to adjust for observed/collected data when randomization was not done or was not feasible. Propensity scores are used to estimate the probability that a data unit is included in the treatment condition using a function of observed data attributes. This procedure can help adjust, statistically, for differences in data attributes across the treatment and control groups.</p>
<p>For example, we would not be able to assign people to smoke randomly, so instead, we need to collect information from people who already smoke compared to those who do not smoke. Due to people self-selecting to smoke or not, these groups would likely differ, which would make the impact of any potential health outcomes vary due to baseline differences. Propensity scores help balance the groups based on observed characteristics before any intervention.</p>
<p>With these simulation tools, you can now not only model realistic quasi-experimental data but also assess how much sample size you need to detect treatment effects reliably.</p>
<section id="simglm-simulation-for-propensity-scores" class="level2">
<h2 class="anchored" data-anchor-id="simglm-simulation-for-propensity-scores"><code>simglm</code> simulation for propensity scores</h2>
<p>In the most recent version of the <code>simglm</code> package on GitHub, support for simulating data using propensity scores is now available. The simulation procedure takes a two-step approach.</p>
<ul>
<li><strong>Step 1</strong>: Simulate the group membership using logistic regression as a function of some data attributes.</li>
<li><strong>Step 2</strong>: Simulate any additional attributes and incorporate the group membership from step 1. Step 1 is essential, as now the group membership would not be randomly assigned; instead, whether someone is simulated to be in the treatment group would depend on the attributes specified in step 1.</li>
</ul>
<p>First, ensure that you install the updated <code>simglm</code> package from GitHub, along with the <code>remotes</code> package.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'lebebr01/simglm'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Here is an example of how step 1 can be specified within the <code>simglm</code> package. A new named element to the simulation arguments, called “propensity,” specifies the components used to generate the group membership. The required elements in here are similar to those from the <a href="https://simglm.brandonlebeau.org/articles/tidy_simulation.html">Tidy Simulation vignette</a>. It is essential to define the attributes that distinguish a person’s inclusion in the treatment or control group using the model formula. In the example below, age and socio-economic status (SES) are the two data attributes being used to define who belongs in the treatment or control group. The regression weights argument specifies the relationship between being in the treatment or control group.</p>
<p>Finally, with the <code>outcome_type = 'binary'</code> specification, logistic regression is used to estimate the propensity scores and generate the probability of being in the treatment or control group.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simglm)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sim_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity =</span> <span class="fu">list</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'ordinal'</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="sc">-</span><span class="dv">7</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ses =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_size =</span> <span class="dv">250</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">5</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">outcome_type =</span> <span class="st">'binary'</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>prop_data <span class="ot">&lt;-</span> <span class="fu">simulate_propensity</span>(sim_arguments)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once we simulate the propensity data, we can visualize the balance between the treatment and control groups by the two data attributes, age and SES.</p>
<section id="age-balance" class="level3">
<h3 class="anchored" data-anchor-id="age-balance">Age balance</h3>
<p>First, examining the balance by age reveals that individuals in the treatment group tend to be older than those in the control group. These are differences that may be meaningful and impact the estimation of the actual treatment effect.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggformula)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>prop_data <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density</span>(<span class="sc">~</span> age, <span class="at">fill =</span> <span class="sc">~</span><span class="fu">factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_labs</span>(<span class="at">fill =</span> <span class="st">"Treatment"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2025-09-24-simglm-propensity_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ses-balance" class="level3">
<h3 class="anchored" data-anchor-id="ses-balance">SES balance</h3>
<p>The SES balance is again in the positive direction, with the treatment group coming from slightly higher SES backgrounds compared to those in the control group. Without adjusting for this, the treatment effect would likely be biased.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>prop_data <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_density</span>(<span class="sc">~</span> ses, <span class="at">fill =</span> <span class="sc">~</span><span class="fu">factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gf_labs</span>(<span class="at">fill =</span> <span class="st">"Treatment"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="2025-09-24-simglm-propensity_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="full-data-simulation-with-propensity-scores" class="level2">
<h2 class="anchored" data-anchor-id="full-data-simulation-with-propensity-scores">Full data simulation with propensity scores</h2>
<p>Below is an example that incorporates a full data simulation with the treatment group generated from the propensity score model (i.e., logistic regression). In this hypothetical example, we aim to model student achievement as a function of motivation, the treatment group (generated via propensity scores), age, and SES. The simulated treatment effect was specified as 1.2. This effect was generated not to be a standardized effect size here, as this is entirely hypothetical; however, it is often easiest to specify effects as standardized effect sizes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sim_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> achievement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> motivation <span class="sc">+</span> trt <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="fu">list</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">motivation =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> <span class="dv">250</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">10</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="fl">0.4</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity =</span> <span class="fu">list</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'ordinal'</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="sc">-</span><span class="dv">7</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ses =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_size =</span> <span class="dv">250</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">5</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">outcome_type =</span> <span class="st">'binary'</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">simulate_fixed</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">simulate_error</span>(<span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">generate_response</span>(sim_arguments)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(sim_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3e645c7c1cd6dda2f073" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3e645c7c1cd6dda2f073">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[-16.55845890248592,17.29923940026248,9.701212938868657,18.52446526932389,-0.9409835851450509,14.80483305788772,-14.13416960535694,-3.138071987607506,27.44647601675095,-27.26698092793321,0.428597426496982,4.477250552642113,-6.085744616196735,-10.3485671405797,-20.26581962291063,10.53020524333922,8.603972250691028,8.286733526278004,-7.303090883442868,-46.24272019956182,13.56173495222184,-14.15524124500364,-38.18497894330684,-6.071537338325513,17.1468218240721,28.39093519235439,-8.50713236315219,5.042612681590456,13.66406578875017,-30.69700574726478,20.12418730877472,45.53493250301324,2.900134636450082,-2.236324864634048,42.24962260234746,-7.100619367338181,44.41673938443834,26.65468771977971,-37.67253265995442,-2.40581903121987,-25.83227925779682,41.8733923062898,-7.343050635382947,17.98941640419773,-19.26909995746879,23.90818050747025,0.5584394607066139,9.172883400424656,9.239809013432209,24.73681111546517,-34.77012118845649,33.94985701098665,13.35290550283043,-2.300496244700075,-1.491953257877089,-28.83741565278581,-1.219931520511901,-35.15320670383323,3.017308561228611,-1.945887162301276,23.93364092177222,4.931948080713309,18.09762216176462,32.17451186890595,-41.14400322301158,-3.318953839898384,2.876235834289242,0.5728649288363266,15.3807203374488,18.13620435077761,-38.77814231649186,26.97860422565028,25.56686249797091,-17.0036673331174,-30.3806538689179,10.70847907652514,-7.596001782677141,16.65821861728465,3.393109038744336,-22.80264114212516,14.91820506529285,-8.284270168762101,-27.40672187072572,-11.96825769004681,13.84804044830275,0.6833210217806508,-20.54697567395236,8.874968451860534,-27.08027126547541,-20.45199046102216,-4.333109549460267,15.66170708946872,25.48351335498129,5.646657754369656,1.552805942576852,-27.37175009604998,44.1600022860576,-6.817594958927563,-8.862771102683764,-16.45603732341294,-43.59725818867307,2.480430232716339,-24.27588106124826,-12.85296805957903,-43.90864140427328,-21.7350263143189,-1.050307954327585,11.43733699653775,3.315690572748914,-18.16205298809074,13.58877244123342,41.59636312796358,40.82527381145916,-47.88043822057145,-4.456055264154759,-7.396529337545506,-26.05437494288935,12.31227848843316,-17.11173826835937,1.55347587482592,-7.394556595817138,13.64389360659302,-1.678323372471594,24.77324592681627,23.26780471752305,24.2763172593412,-15.35501934283107,-0.6354400318591027,14.2554484322648,17.27123025939448,-12.06054051283826,22.06607936794983,-27.01044678467724,5.197352954496878,4.421627461017471,7.313157937388649,-20.8749329339412,-8.26417993676816,-26.58088633184399,-12.18873400132542,24.5511292343209,-1.921963620787735,16.84171468505493,15.76155441004192,23.23529791144836,21.49829076594619,12.07843339888906,-22.77681097519452,-35.91947386878233,2.703099028783671,7.966790118742678,-13.85877577796134,-10.39876860038603,8.289448913968933,-25.12910405341611,-26.43143670675071,11.72384510376607,-0.370606047027141,27.52266540581109,-11.0874851184684,-25.62150039587912,5.999627489536406,9.657931278079264,-2.552875463820439,18.21198862993963,13.16007548053502,8.21035356089428,20.82796877657735,-9.697123784114691,8.965627458272929,-8.152753324946115,-17.6997577591943,-6.461133745859408,17.2094648585025,-45.00618300078276,1.677629694695227,6.753396674907136,3.834760816842659,-35.47469773503118,9.025467759531397,-14.61270618138413,4.389618991050192,-16.58753623579161,-12.03680336333801,14.86066331833145,-17.90702159466649,21.42292750342666,-5.572859852424973,13.56831805250456,-15.6745108602843,13.70866627983224,34.73485134586391,-1.557598691323445,-5.203711881258272,-16.40388682592403,36.38565393687436,-28.5320554054541,1.814818825512794,-5.395238666451529,-41.83018696420937,-1.516208534567222,10.65256953538318,-5.667748995912614,8.434698654104213,15.24254804730094,6.314365164363464,13.26263496426614,25.87263929435196,-17.2080159736773,-19.07101932349395,3.114756054203565,4.416131194741259,8.574836342380227,27.71255633293357,26.16398114133734,-41.47521305554876,1.023709234892819,13.5183557628988,-11.49458498310866,-7.082639999798564,11.84906087647126,14.89207845713697,-10.80921872164412,-27.8326718328033,-35.17887019070005,2.886956087935841,-7.757819195409733,-12.1855131199057,-52.96369177724721,7.074463634027621,32.08990948518589,-23.0254240843293,34.1779643896953,-19.52538967782719,-9.015869962689143,1.215894244527626,12.35465935923471,-44.27322715008293,-2.119756569141113,23.75620976201041,-22.72833861201397,-0.7748176507205797,-20.32851590040576,5.194081080801008,-20.20333466111067,-21.77718614656908,29.71790534741652,-18.31689044553388,-21.39381034891035,-1.782145802194254],[1,1,0,1,1,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,0,1,0,1,0,0,0,1,1,0,1,1,1,1,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,0,1,1,0,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,1,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,1,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,0,1,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,1,1,0,1,0,1,1,1,0,1,0,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,0,0,1,0,1,1,1,1,0,1,1,1,0,1,1,1,1,0,1,0,0,1,1,1,1,0,1,0,0,1,0,0,1,0,1,1,1,1,0,0,1,0,1,0,1,1,0],[-7,-5,-7,-2,-6,-6,1,7,-5,-3,5,6,1,-7,2,7,-4,-4,1,3,7,-6,5,1,-7,-3,7,-6,0,-7,-4,-7,-1,6,6,7,7,-6,-7,1,0,7,-6,-5,3,3,7,-6,4,0,-1,-2,-4,0,-2,-7,5,2,2,6,-4,3,-2,-7,-6,2,3,3,6,4,7,-1,-5,-7,5,-3,-4,4,4,-3,-3,7,-6,6,-7,-5,-1,4,4,-7,-6,4,-5,6,-4,-3,3,-4,5,-2,-2,-5,0,-5,1,-7,3,4,-6,3,-7,-1,-1,5,-7,2,4,5,0,-6,-4,-2,7,-7,4,-3,-4,5,-7,4,4,-5,5,-6,5,-4,-4,7,-5,-1,-1,-6,-2,6,3,4,6,0,4,-2,2,-6,0,7,1,1,6,0,-3,7,5,-5,-2,6,0,-3,-1,0,5,-7,0,-5,6,6,1,6,0,7,-4,-2,1,-5,-3,5,-6,4,-5,-6,5,-1,-7,4,-1,-7,3,-7,1,-7,1,1,4,-2,-5,-5,-6,0,-1,-1,3,6,2,-7,-5,-1,1,-2,0,-1,3,0,2,1,-5,-4,6,1,1,4,0,1,6,-3,7,6,5,-7,1,6,5,1,5,-6,-7,-1,-1,3,-4,0,-2,-7],[-0.5668457047442026,6.625256175252963,9.73809159474278,-4.108464734025224,-0.691790126471442,-2.34443566411296,-5.679145272468562,5.097174319233294,2.9208452561578,6.569923316056786,-12.44861145127066,-4.65326843212136,-5.687166590597831,4.189817859204343,-1.010888459751025,1.594815831835537,-0.8344142323376609,2.954128799984772,2.457056005567118,2.008448514871862,5.041645515558848,-10.684153047889,-1.04201159680134,-1.872634780307984,1.477369782025335,-7.515289433461053,3.65413575340902,-0.5114714704274889,-3.883984684780344,7.763307510953926,4.920464783404968,1.039276692045709,-4.861231304195584,5.306111261505825,-11.84541887258619,-2.926892233438049,2.735389543486954,1.990916683877939,-5.33852033896295,1.467300020735296,2.812603952673065,10.22090835703349,-6.655138153849594,2.464636635094234,-9.226469451836467,3.692150346594874,-2.01878154568496,7.722826413227009,-3.130618710049191,-1.235046075703161,-2.086129306973785,-6.52723143732966,3.862428613561673,5.464324105596814,0.2800892615708512,3.076812043027077,-3.035679038514052,0.3166092977937163,3.894809652351654,-3.729003802377526,9.924350566447179,7.369133088900367,3.332760507401274,-6.279207908336893,1.320785853887306,-6.380594850534993,-3.020325029740428,1.654979469804705,4.314599783634689,-4.478981064068116,1.155872882201042,1.620726523857735,7.73466865646891,6.350044789837308,0.2430078757330123,-1.448691156225461,0.1285615979958726,-10.96661961306703,0.894918862889049,-3.68960449428275,10.63556426430708,0.9119204452787543,4.280479386051713,-6.379528181533791,-3.912617044798024,-3.632691101434587,0.401581963399291,-2.82761786415175,3.637231658037061,-0.5913843272220566,-2.772835747458527,-0.5117621180944263,-2.535295431719675,-1.150777235404185,0.5574724371424915,10.37668391050936,5.267958330043049,5.537827262780742,-2.701166232779765,2.522536366894431,0.6940880456111926,-6.085200322149542,5.560044830791725,-6.64054763188238,-3.496872951464112,-3.62331872100475,-4.967711965088687,-7.63772438628758,-11.4636630223683,-3.108800491046063,3.050337827370897,-3.045870773187384,-6.84985623515094,-9.260100054411787,-2.179407241885081,-1.207834207836973,2.587330631909323,-1.895387950877575,3.752675861115593,0.5508701120912097,5.969129943616821,4.300954468143888,-6.785636864417787,1.879469732315574,-3.187829768859744,-1.997112796757327,-1.866029717662205,6.569549209006019,3.358453790877735,4.704508985624797,4.28247332681728,1.579135152729397,-3.354784396653984,-2.852772750385706,-6.867246290446619,1.848489517530112,10.9850012432611,3.934371657127226,-0.4482245134214571,-4.872886900311643,-4.349661118953405,-8.249251782404709,-2.102953375647686,2.289845087310945,-9.906145184458088,-6.044496936003894,-4.077453094565558,0.5294293333482316,1.453780825528149,2.470347325723408,2.210864093640994,4.346712946739697,-3.021709062020581,-4.790789955303213,-4.771097657276288,0.8682084256760951,0.5637865708433188,-3.353009199748592,-0.4997391798259301,-11.84250989879932,-0.5738474534942746,-2.055404324137824,0.9921636435106043,8.730795685435851,3.069138940601474,2.746596733810776,5.446824884332095,-3.887999051175609,2.723311780008575,3.418709576668606,0.3027068703844082,0.4638093995769824,-1.848032534551543,3.404522192447963,3.263542322242184,5.354169139696595,13.11548445863712,-9.701065790819024,9.237398716991516,-0.2242524186646407,-2.087985055934745,-5.295788501079231,-1.576868507611608,-1.829255372494107,3.963953543817677,-0.8919748040894888,-3.624005085737836,-9.885019360206007,4.568403025393065,6.184766686574401,0.8166093880557806,8.7339306867757,-5.146270837991946,0.340110936841073,-1.61222951494303,-5.091209146095928,0.9528992779529265,-5.548414837018855,8.393392004716356,7.004502336912916,-3.048834775969818,-1.538490873911576,2.985108922154423,1.445897969385556,11.78182956119013,-6.081233110207691,7.998113153271436,6.643751960708783,1.774385764230015,-4.468519155823408,-2.822946761784022,-1.201151091859724,-1.976782905004849,1.507453102791779,3.206999049737042,11.46976482504902,-3.790264524106569,1.954729779080937,-12.44958508983462,-4.942621283383419,6.657321013140961,-0.7934155703934735,1.060649550326108,-0.3117444849528598,-10.8276149783334,-9.053135325919454,-5.312500209409635,-6.147469176747048,1.791179898366153,0.05380448336849798,4.302967539114849,7.984939603556641,-4.591920070387112,4.382732098768985,-1.075803886646556,-5.443734639730065,5.914230496124727,-4.861874150069683,-2.868655705514682,-0.4762313030698368,7.646170995577459,0.7027030103886229,1.340239565886995,-4.006252241392149,1.732506505827153,-2.30479724364731,5.692807461567222,1.487063274685764,-3.83976185325269,-0.2155058937655596],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250],[-3.425243366729406,-3.723872841970961,-3.078326259438465,5.245247118050915,0.5307832045558641,-2.07100967534756,-0.5854613536696461,0.4384622671262099,-2.931924732175457,1.698205991259877,0.06853277807271557,-2.212714158930331,-0.3055543538185877,-4.085197970719627,-6.031925063583844,-2.140216091450667,4.591372263986766,-7.728181229228253,-1.018336703836586,3.137529752565141,-2.138565883449017,-0.08492461480101508,-0.7082494194339866,1.635448582962554,-0.6706314339752364,-2.350050486431297,1.605908837967867,0.3964230692080143,0.2595926747043157,7.96709493155864,-1.829511271563591,-2.486941368732572,3.686538938632903,2.51148733044558,-4.92383994528912,1.85023700378965,-1.10518267477508,-7.874898966935078,0.9673024414992006,3.197089821592768,1.824626308069635,-2.922666583482085,-7.685909756217782,-0.3567533501733109,1.655681836435394,-0.2356237433001758,-3.610890522534211,0.9671897409384076,-1.652525318537087,-4.958299562487731,-1.853428582038681,1.291413416866193,0.7720376950721923,0.8393342112219431,-0.2954253947561827,-5.503046031136953,2.348181889171016,0.8090277984417618,-0.3804896152457887,0.3885684283144496,-1.582227851936296,0.6994975382619334,0.4502226663810938,-0.6205717983689868,3.841130863535367,0.9344722882265063,0.5753168302330917,0.7870840400030306,-0.6120268148802382,4.708764740210771,-3.680500580337674,-1.622263757721598,4.079231859824328,5.463850683994083,-1.6677751175052,3.461147142766395,-2.908906604192808,3.41814801991921,1.623533371435185,-0.08282887327774216,-1.83432696813763,-4.756838088043952,-0.02869952017039232,-4.222202339844292,-2.523233519560401,-5.084775302765106,3.326595579806014,-4.455427289555426,7.603611912534933,-0.4529275310683488,4.568302097388284,2.432858483571321,3.177718207738133,-1.974401283302359,-2.75188814300295,2.278731704961784,2.32777720184835,1.282678483424599,-2.208022832085366,-3.022014763292178,0.9898388445927069,-1.12675096842153,1.17406507357879,-1.17094991312706,-0.8412897445451443,-0.9052072737565594,-2.301979719576072,2.17919486594656,2.315379018954409,2.52023484293379,0.4746516924887326,4.25596473091821,2.267902908271146,-0.6084494796073194,6.289407773981322,0.5705267168134308,-2.102375811473357,3.175867624078354,-2.438957412381099,0.7880670757956473,-2.656964035922448,-0.2787078652877469,3.898593512307463,-0.5274065230179149,6.381753938616047,-2.196023713572595,4.720413203812158,4.430831187998134,5.638535841404022,-3.245188318869551,-0.208683042902622,-1.91616537014522,-0.2685862224198532,1.124872216061314,1.056727679683155,-2.935187546652398,-0.8517317250473015,-1.118553231765945,-1.37475594251596,0.7193690374558771,-0.8781016960877547,1.547630514878411,0.9427479931888013,-2.254748897244021,-3.219177124569796,0.2142762741328437,-0.4096526684800967,10.12362405463166,-2.279300955923391,-0.8321415302119602,4.614710211107152,1.877469161803094,3.288311267624886,-2.074711383337268,-3.522850773944294,-0.01557740730387071,0.7073870888919863,-3.449291017755609,1.66760306239967,-0.9012614762033953,-6.157405563070357,1.167951110914507,-1.899931698762311,-3.005279057006933,6.493138078321995,-2.524647830129905,-1.319887080346277,-0.9043212899127926,-1.160715217638896,-3.334413495432309,-1.357388873422274,2.618378673660295,0.2642750012911342,2.734866011805584,2.014174057721707,0.8193867998816453,1.185583517003448,1.420974833790937,3.554743662989642,2.864311805629602,-0.4570345960870497,-2.092630774961079,0.7812979214783955,-2.454636827769475,2.747875188003513,0.8786870443752305,3.00358751371594,0.6442934381865583,-1.065463030576793,1.76675607829296,1.563824586056346,-3.470177628589215,-5.364380169835634,2.244735694150217,1.073584736596905,4.304540868943297,1.099203006307767,-0.4709582760293033,-3.344228658344678,3.728260930944006,-2.43741278922565,5.49511748962086,2.034966985260796,1.475717822118873,0.1959583527699496,1.306109669235363,0.6266855025112131,4.248584549974236,-0.4525616309566651,3.977766845590075,2.491980255456075,0.01157011309584581,-0.3614211518111787,-0.6766964005654647,0.6309983692135889,1.751141717791936,7.381531904967448,4.742696919904063,-1.076406464216402,4.027814246979125,-3.678602260322423,9.550653617363396,-2.554089719588347,-1.100687512223623,2.616298258009222,4.184467128648705,0.3510676862761439,0.2171513821871607,-2.863695723825071,0.02338590435634466,-3.826480824107969,-1.648942185399633,4.314649419386618,-2.311501629666958,0.05497824003565751,-3.61545574017924,2.648030634016356,0.1125632912696495,-2.813333107643236,-2.709366578055062,-6.196336018413316,4.514995933922968,5.524958469573407,-5.181677048225765,-3.549387454187056,5.859059952766536,-3.313539913913943,3.395986042578131,3.891266564070795,-1.157877156395171],[43.73490501281958,59.27600980391824,55.61500807423315,57.38266992422325,50.05065903432412,55.93582430712685,44.22654583974009,50.71906478476532,61.20880172073983,41.63568845784092,48.75928610778113,52.42758311302651,47.44391050587186,46.2080276085692,43.040950035898,56.51078605529458,54.03298534219201,53.6532256105074,48.99302764801464,33.50502404889324,58.58510535977845,42.26686524002629,36.16550552347693,47.20322636959281,56.52807117513517,60.3775517185765,48.21068099309138,52.48917720502931,54.49463014430498,38.96202457883257,58.87979111936114,68.97379217421671,51.04474602853114,51.03199786952284,65.73849432279243,48.32802919470522,70.35054313964709,61.75960425888137,34.09635685127749,50.70449739269588,41.57023928504955,70.00458401177428,45.99899520738442,58.51192572045265,41.48574265405337,60.78630978963682,51.61868039786141,54.99985996347662,54.51326892786059,60.78596292726028,36.67041919787395,61.74813494506225,57.10676935452259,51.64588252851917,50.47324101224188,38.53423674964244,50.45310763216673,37.41786964291514,52.38062583757936,50.08939418448512,61.65454401032068,54.11506250451041,57.87223899155617,61.80000277047816,34.4725951742672,48.4772697514069,51.89541307628059,52.14289083898571,59.0309380808882,57.73473647429402,36.67771129395352,62.29662332122455,61.66041216330559,44.08604426421236,39.60849042136609,54.82121884155369,46.59373968642812,55.52163254364711,51.98097333122,40.85654241957926,58.32617309219391,48.81427204381485,40.70743109822264,45.41781487859783,55.0610619181216,50.06515563335362,42.98160522126888,54.44308291470627,41.6771994083191,40.97135773378562,48.17354724335127,57.73674230626388,59.0595814840626,53.77096879289682,50.36049048631637,41.34547093920735,69.2809904969338,48.25741883212417,47.47960000073155,43.84821916235843,33.73461873593357,50.17087201254915,42.87965878319863,43.8986758681978,32.86232520042466,39.70015979402125,49.83794882699679,54.26550370204321,47.86036047350748,43.45797868200219,55.49809343333609,66.97707755788859,65.71764546579594,30.23279969816847,48.17272608386683,48.13942971302256,40.62508268082158,56.15106440765388,45.29347365793515,51.35910787795317,48.13445984757735,57.53279605967318,49.53226143490692,59.6791658038054,60.11016444479428,60.11124870454715,44.19148483345202,51.88821128950786,55.84179282062535,59.68461935016399,46.64640212656901,58.72121553536228,40.05712518696561,51.96574799420233,51.75183941179534,54.18738555433799,43.9962771372388,49.57792093957455,38.75558933890704,45.00628467439192,59.83303641399001,47.76890160608373,57.21094753011005,58.6770830358445,58.31758286846482,58.6881920723775,55.61201008591424,42.22163294325925,37.59565565886911,52.69882644294432,55.13943207090733,44.94316792550039,46.28506529434044,54.01808207676178,40.05558396431449,40.94447742371874,56.63048468421727,50.213505281252,60.58413136736796,44.50437847791282,41.30793797827479,52.58599991478011,55.11121342210935,52.96154873583079,58.05208018712622,55.65067937566671,54.54584764544074,58.55918774783704,48.50197843135627,53.74092837747632,46.81457538761766,42.53604924621652,47.55353836801835,59.53491649151299,34.11341238024745,53.80959416280225,55.98022978462214,51.00863787903231,37.71947058523541,54.5541239991464,44.93292126346267,51.13190047115027,42.67076837878046,46.42796481154127,56.335253713287,44.21419766111103,58.3631697299362,45.89960121897851,58.26942797735009,45.17638732752987,54.98761885894684,66.47742321003949,49.19039281397264,48.50354298170696,44.53538789089463,63.78145928822576,40.12540265730659,48.6388238209504,50.04025253459848,35.11905079854448,50.23130789218066,54.87640509567538,49.17917763217356,53.23535395398807,58.44247660921791,52.20543778819346,57.20458227402432,63.10999370791798,45.06039005158658,43.05446248164657,51.94016573123543,50.76616470493157,53.63573881070088,62.56188580887137,62.5673422189692,36.07735598404275,50.66191756293049,56.99602474992976,43.78976973429788,47.13128867923472,56.60395460387375,57.05847749025642,45.44147489892388,38.38899514564046,35.02154817913664,50.19149860369448,46.86874726948371,45.18892745785096,29.26231826369266,54.14323657445318,64.51170567885308,42.48606526715744,64.42320573828134,43.88552715356138,46.6247010432627,49.62542403787854,56.52042136772507,32.87524060244941,50.13493344596489,60.68342607903671,44.52020730408878,49.26574869230893,41.50365353130945,52.17606937197237,42.25179276201252,42.21292623046055,62.91036400435841,44.24500964045789,41.48253539712269,48.53326520568091],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[[40.30966164609018],[55.55213696194728],[52.53668181479469],[62.62791704227416],[50.58144223887999],[53.86481463177929],[43.64108448607045],[51.15752705189153],[58.27687698856437],[43.3338944491008],[48.82781888585384],[50.21486895409618],[47.13835615205327],[42.12282963784958],[37.00902497231416],[54.37056996384391],[58.62435760617877],[45.92504438127914],[47.97469094417805],[36.64255380145838],[56.44653947632943],[42.18194062522527],[35.45725610404294],[48.83867495255536],[55.85743974115993],[58.0275012321452],[49.81658983105925],[52.88560027423732],[54.7542228190093],[46.92911951039121],[57.05027984779755],[66.48685080548414],[54.73128496716404],[53.54348519996842],[60.81465437750332],[50.17826619849487],[69.24536046487201],[53.88470529194629],[35.06365929277669],[53.90158721428865],[43.39486559311918],[67.0819174282922],[38.31308545116664],[58.15517237027934],[43.14142449048876],[60.55068604633664],[48.0077898753272],[55.96704970441503],[52.8607436093235],[55.82766336477255],[34.81699061583527],[63.03954836192844],[57.87880704959478],[52.48521673974112],[50.1778156174857],[33.03119071850548],[52.80128952133774],[38.2268974413569],[52.00013622233357],[50.47796261279957],[60.07231615838439],[54.81456004277234],[58.32246165793726],[61.17943097210917],[38.31372603780257],[49.41174203963341],[52.47072990651368],[52.92997487898874],[58.41891126600796],[62.44350121450479],[32.99721071361585],[60.67435956350295],[65.73964402312991],[49.54989494820644],[37.94071530386089],[58.28236598432009],[43.68483308223531],[58.93978056356632],[53.60450670265519],[40.77371354630152],[56.49184612405628],[44.0574339557709],[40.67873157805225],[41.19561253875354],[52.5378283985612],[44.98038033058852],[46.30820080107489],[49.98765562515085],[49.28081132085403],[40.51843020271728],[52.74184934073955],[60.16960078983521],[62.23729969180073],[51.79656750959447],[47.60860234331341],[43.62420264416914],[71.60876769878215],[49.54009731554876],[45.27157716864618],[40.82620439906626],[34.72445758052627],[49.04412104412762],[44.05372385677742],[42.72772595507074],[32.02103545587952],[38.79495252026469],[47.53596910742072],[56.44469856798978],[50.17573949246189],[45.97821352493598],[55.97274512582482],[71.2330422888068],[67.98554837406708],[29.62435021856115],[54.46213385784815],[48.70995642983599],[38.52270686934823],[59.32693203173223],[42.85451624555405],[52.14717495374882],[45.4774958116549],[57.25408819438543],[53.43085494721439],[59.15175928078748],[66.49191838341032],[57.91522499097456],[48.91189803726418],[56.319042477506],[61.48032866202937],[56.43943103129444],[46.43771908366639],[56.80505016521706],[39.78853896454575],[53.09062021026364],[52.80856709147849],[51.25219800768559],[43.1445454121915],[48.4593677078086],[37.38083339639108],[45.7256537118478],[58.95493471790225],[49.31653212096214],[58.15369552329886],[56.42233413860048],[55.09840574389502],[58.90246834651035],[55.20235741743414],[52.34525699789091],[35.31635470294572],[51.86668491273235],[59.75414228201448],[46.82063708730348],[49.57337656196533],[51.94337069342451],[36.53273319037019],[40.92890001641487],[57.33787177310925],[46.76421426349638],[62.25173442976763],[43.60311700170942],[35.15053241520443],[53.75395102569462],[53.21128172334704],[49.95626967882386],[64.54521826544821],[53.1260315455368],[53.22596056509446],[57.65486645792425],[47.34126321371738],[50.40651488204401],[45.45718651419539],[45.15442791987682],[47.81781336930948],[62.26978250331858],[36.12758643796916],[54.6289809626839],[57.16581330162559],[52.42961271282325],[41.27421424822505],[57.418435804776],[44.47588666737562],[49.03926969618919],[43.45206630025886],[43.97332798377179],[59.08312890129051],[45.09288470548626],[61.36675724365215],[46.54389465716507],[57.2039649467733],[46.94314340582283],[56.55144344500319],[63.00724558145028],[43.826012644137],[50.74827867585718],[45.60897262749153],[68.08600015716905],[41.22460566361436],[48.1678655449211],[46.6960238762538],[38.84731172948848],[47.79389510295501],[60.37152258529624],[51.21414461743436],[54.71107177610695],[58.63843496198785],[53.51154745742883],[57.83126777653553],[67.35857825789222],[44.60782842062991],[47.03222932723665],[54.43214598669151],[50.77773481802741],[53.2743176588897],[61.88518940830591],[63.19834058818279],[37.82849770183469],[58.04344946789794],[61.73872166983382],[42.71336327008148],[51.15910292621385],[52.92535234355133],[66.60913110761982],[42.88738517933553],[37.28830763341684],[37.63784643714586],[54.37596573234318],[47.21981495575985],[45.40607884003812],[26.39862253986758],[54.16662247880953],[60.68522485474511],[40.83712308175781],[68.73785515766795],[41.57402552389442],[46.67967928329836],[46.0099682976993],[59.16845200174143],[32.98780389371906],[47.32160033832165],[57.97405950098165],[38.32387128567547],[53.78074462623189],[47.02861200088285],[46.9943923237466],[38.70240530782547],[48.07198618322708],[59.59682409044447],[47.64099568303602],[45.37380196119349],[47.37538804928573]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>X.Intercept.<\/th>\n      <th>motivation<\/th>\n      <th>trt<\/th>\n      <th>age<\/th>\n      <th>ses<\/th>\n      <th>level1_id<\/th>\n      <th>error<\/th>\n      <th>fixed_outcome<\/th>\n      <th>random_effects<\/th>\n      <th>achievement<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"X.Intercept.","targets":1},{"name":"motivation","targets":2},{"name":"trt","targets":3},{"name":"age","targets":4},{"name":"ses","targets":5},{"name":"level1_id","targets":6},{"name":"error","targets":7},{"name":"fixed_outcome","targets":8},{"name":"random_effects","targets":9},{"name":"achievement","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The simulation process uses the treatment, age, and SES data generated from the propensity score process. That is, these attributes are not regenerated in the process, but are simulated first, then any additional fixed effects are simulated to work through the simulation pipeline.</p>
</section>
<section id="estimate-propensity-models-with-simglm" class="level2">
<h2 class="anchored" data-anchor-id="estimate-propensity-models-with-simglm">Estimate propensity models with <code>simglm</code></h2>
<p>The model estimation process is done similarly to the simulation process. Two models are estimated via a two-step process.</p>
<ul>
<li><strong>Step 1</strong>: A propensity score model is estimated to estimate the probability of being in the treatment group. This is controlled via the <code>propensity_model</code> simulation arguments below.</li>
<li><strong>Step 2</strong>: A full model is estimated, specified via the <code>model_fit</code> simulation arguments. The propensity scores can be included in three different ways via the “propensity_type” simulation argument:
<ul>
<li><strong>covariate</strong>: The propensity score probabilities are included as a covariate in the final model.</li>
<li><strong>ipw</strong>: Inverse propensity score weighting is used and passed to the weights argument of the model.</li>
<li><strong>sbw</strong>: Stabilized propensity score weighting is used and passed to the weights arguments of the model. The stabilized weights use the mean of the propensity scores instead of 1, which can help limit weights that are excessively large or small.</li>
</ul></li>
</ul>
<section id="covariate-adjusted-model" class="level3">
<h3 class="anchored" data-anchor-id="covariate-adjusted-model">Covariate-adjusted model</h3>
<p>The covariate-adjusted model includes the propensity score as a covariate in the final model via the <code>propensity_type = 'covariate'</code> argument.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sim_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> achievement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> motivation <span class="sc">+</span> trt <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="fu">list</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">motivation =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">10</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="fl">0.4</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity =</span> <span class="fu">list</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'ordinal'</span>, </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="sc">-</span><span class="dv">7</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ses =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>, </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">5</span>),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">outcome_type =</span> <span class="st">'binary'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_fit =</span> <span class="fu">list</span>(<span class="at">formula =</span> achievement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> motivation <span class="sc">+</span> trt <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">model_function =</span> <span class="st">'lm'</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity_model =</span> <span class="fu">list</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">propensity_type =</span> <span class="st">'covariate'</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_fixed</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulate_error</span>(<span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate_response</span>(sim_arguments)<span class="sc">|&gt;</span> </span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_propensity</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_fit</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_coefficients</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   51.1     0.912       56.0  6.71e-310
2 motivation     0.402   0.00480     83.7  0        
3 trt            1.34    0.257        5.21 2.30e-  7
4 age            0.145   0.0383       3.79 1.58e-  4
5 ses            0.208   0.0582       3.57 3.75e-  4
6 propensity    -1.75    1.31        -1.34 1.80e-  1</code></pre>
</div>
</div>
</section>
<section id="inverse-propensity-score-weighting" class="level3">
<h3 class="anchored" data-anchor-id="inverse-propensity-score-weighting">Inverse Propensity Score Weighting</h3>
<p>To specify inverse propensity score weighting, <code>propensity_type = 'ipw'</code> is specified. Note that the propensity scores are no longer included as a covariate.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sim_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> achievement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> motivation <span class="sc">+</span> trt <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="fu">list</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">motivation =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">10</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="fl">0.4</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity =</span> <span class="fu">list</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'ordinal'</span>, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="sc">-</span><span class="dv">7</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ses =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">5</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">outcome_type =</span> <span class="st">'binary'</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity_model =</span> <span class="fu">list</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">propensity_type =</span> <span class="st">'ipw'</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_fixed</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulate_error</span>(<span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate_response</span>(sim_arguments)<span class="sc">|&gt;</span> </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_propensity</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_fit</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_coefficients</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   49.9     0.203      246.   0       
2 motivation     0.406   0.00510     79.7  0       
3 trt            1.12    0.253        4.43 1.03e- 5
4 age            0.129   0.0241       5.35 1.07e- 7
5 ses            0.272   0.0226      12.0  3.50e-31</code></pre>
</div>
</div>
</section>
<section id="stabilized-propensity-score-weighting" class="level3">
<h3 class="anchored" data-anchor-id="stabilized-propensity-score-weighting">Stabilized Propensity Score Weighting</h3>
<p>To specify stabilized propensity score weighting, <code>propensity_type = 'sbw'</code> is specified. Note that the propensity scores are no longer included as a covariate.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim_arguments <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> achievement <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> motivation <span class="sc">+</span> trt <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="fu">list</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">motivation =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">10</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="fl">0.4</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity =</span> <span class="fu">list</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixed =</span> <span class="fu">list</span>(<span class="at">age =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'ordinal'</span>, </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="sc">-</span><span class="dv">7</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ses =</span> <span class="fu">list</span>(<span class="at">var_type =</span> <span class="st">'continuous'</span>, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample_size =</span> <span class="dv">1000</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> <span class="fu">list</span>(<span class="at">variance =</span> <span class="dv">5</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">reg_weights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">outcome_type =</span> <span class="st">'binary'</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">propensity_model =</span> <span class="fu">list</span>(</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">formula =</span> trt <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> ses,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">propensity_type =</span> <span class="st">'sbw'</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_fixed</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simulate_error</span>(<span class="at">sim_args =</span> sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate_response</span>(sim_arguments)<span class="sc">|&gt;</span> </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_propensity</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_fit</span>(sim_arguments) <span class="sc">|&gt;</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_coefficients</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  50.2      0.206      244.   0       
2 motivation    0.402    0.00528     76.1  0       
3 trt           1.03     0.259        3.99 6.99e- 5
4 age           0.0942   0.0248       3.80 1.54e- 4
5 ses           0.239    0.0232      10.3  1.35e-23</code></pre>
</div>
</div>
<p>Each of these approaches has the potential to produce a more balanced comparison between the treatment and control groups for observed data attributes. The primary limitation of propensity scores compared to actual random assignment is that they cannot adjust for any differences in data attributes that are unobserved. True random assignment can help ensure that the treatment and control groups are balanced with respect to observed and unobserved data attributes. Even with this limitation, propensity scores are preferable to doing nothing when random assignment is not possible or cannot be performed.</p>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>The next step is to ensure that these propensity score simulation and model estimation steps are included in the broader functions to perform replications. This will enable the estimation of power for planning a study that aims to implement propensity scores.</p>
<p>If you work with non-randomized designs, simglm can now help you simulate realistic scenarios, test different adjustment methods, and plan studies with more confidence.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/brandonlebeau\.org");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div class="social-links">
<p><a href="mailto:brandon-lebeau@uiowa.edu" title="Email"> <i class="fa fa-envelope fa-lg"></i> </a> <a href="https://twitter.com/blebeau11" title="Twitter"> <i class="fa-brands fa-linkedin fa-lg"></i> </a> <a href="https://github.com/lebebr01" title="GitHub"> <i class="fa-brands fa-github fa-lg"></i> </a></p>
</div>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Brandon LeBeau</p>
</div>
  </div>
</footer>




</body></html>